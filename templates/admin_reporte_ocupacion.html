<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Ocupación Anual</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { background-image: url("{{ url_for('static', filename='hotel_fondo.jpeg') }}"); background-size: cover; min-height: 100vh; padding-top: 80px; }
        .container { background-color: rgba(255,255,255,0.98); padding: 30px; border-radius: 10px; }
    </style>
</head>
<body>
    <div style="background-color: black; height: 60px; width: 100%; position: fixed; top: 0; z-index: 1000; display: flex; align-items: center; padding-left: 20px;">
        <a href="{{ url_for('home') }}"><img src="{{ url_for('static', filename='hotel_logo_secundario.png') }}" alt="Logo" style="height: 50px;"></a>
    </div>

    <div class="container">
        <h2 class="mb-4" style="color: #D0963E; font-family: 'Cambria Math', serif;">Ocupación Mensual (Noches)</h2>

        <form method="POST" class="row g-3 mb-4 align-items-end">
            {{ form.csrf_token }}
            <div class="col-md-4">
                {{ form.anio.label(class="form-label") }}
                {{ form.anio(class="form-select") }}
            </div>
            <div class="col-md-2">
                {{ form.buscar(class="btn btn-dark w-100") }}
            </div>
        </form>

        <div style="height: 400px;">
            <canvas id="graficoOcupacion"></canvas>
        </div>

        <a href="{{ url_for('admin_reportes_menu') }}" class="btn btn-secondary mt-4">Volver</a>
    </div>

    <script>
        const ctx = document.getElementById('graficoOcupacion');
        const datosMensuales = {{ datos | tojson }};

        new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic'],
                datasets: [{
                    label: 'Noches Ocupadas - Año {{ anio }}',
                    data: datosMensuales,
                    backgroundColor: 'rgba(208, 150, 62, 0.6)',
                    borderColor: 'rgba(208, 150, 62, 1)',
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: {
                        beginAtZero: true,
                        title: { display: true, text: 'Cantidad de Noches' }
                    }
                }
            }
        });
    </script>
</body>
</html>